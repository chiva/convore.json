[{"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854503.0536799, "message": "2) in save_model, I save the new object", "group_id": 81, "id": 322642}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299855127.230953, "message": "After 2a, I'm calling Subscription.objects.count() and getting 1", "group_id": 81, "id": 322781}, {"user_id": 275, "stars": [{"date_created": 1299965160.718395, "user_id": 141}], "topic_id": 12323, "date_created": 1299854422.3651249, "message": "This is going to be a bit involved, but here goes:", "group_id": 81, "id": 322626}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854455.256211, "message": "I'm working on a service that implments the pubsubhubbub protocol, which means that when subscribing to a new feed, the following happens...", "group_id": 81, "id": 322634}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854473.6836209, "message": "1) In this case, from the admin, a new Subscription object is created", "group_id": 81, "id": 322636}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854591.0030689, "message": "3) I construct a create-subscription call to the hub", "group_id": 81, "id": 322658}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854623.3177979, "message": "4) I call the hub, passing the verify_token", "group_id": 81, "id": 322666}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299855284.6374891, "message": "That's between 5) and 6)", "group_id": 81, "id": 322802}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854532.473901, "message": "2a) a verify_token is created and saved with the object", "group_id": 81, "id": 322650}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299855246.598918, "message": "In the code that responds to the hub's verification, which happens 1 second after the first object is saved, I call Subscription.objects.count() and get 0!", "group_id": 81, "id": 322796}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299855305.178478, "message": "The app is running under mod_wsgi.", "group_id": 81, "id": 322806}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854975.4530351, "message": "6) the app fails to find the Subscription object based on the verify_token", "group_id": 81, "id": 322743}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299854924.6477759, "message": "5) the hub then calls back to the app, confirming the verify_token", "group_id": 81, "id": 322733}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299857625.980804, "message": "https://github.com/sivy/typepadapp/blob/master/typepadapp/views/feedsub.py#L190", "group_id": 81, "id": 323170}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299857550.5674889, "message": "2a is happening here:", "group_id": 81, "id": 323143}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299857625.0530679, "message": "and 6) is happening her:", "group_id": 81, "id": 323169}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299857551.5200291, "message": "https://github.com/sivy/typepadapp/blob/master/typepadapp/admin.py#L126", "group_id": 81, "id": 323144}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1299964927.79726, "message": "but if it rolls back or isn't committed by the time you get() for it in step 6 it won't exist", "group_id": 81, "id": 336455}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1299965084.4917059, "message": "but if you're really using transactions maybe that's weirding it", "group_id": 81, "id": 336492}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1299964908.128006, "message": "@steveivy is it your transaction support? if you create the object then count() for it inside a transaction, that means it counts the object, i think?", "group_id": 81, "id": 336450}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1299965034.2637229, "message": "normally you'd get committed right after the obj.save() in SubscriptionAdmin.save_model() http://docs.djangoproject.com/en/1.2/topics/db/transactions/#django-s-default-transaction-behavior", "group_id": 81, "id": 336481}, {"user_id": 275, "stars": [], "topic_id": 12323, "date_created": 1299975211.5775681, "message": "@markpasc - yeah, it turned out that adding transaction.commit() right after the save() did the trick.", "group_id": 81, "id": 337778}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1299995835.010057, "message": "@steveivy yay!", "group_id": 81, "id": 339162}, {"user_id": 275, "stars": [{"date_created": 1300044122.8653901, "user_id": 141}], "topic_id": 12323, "date_created": 1300026699.338155, "message": "I had bradc to thank for that :-)", "group_id": 81, "id": 341100}, {"user_id": 141, "stars": [], "topic_id": 12323, "date_created": 1301614421.0793309, "message": "@steveivy yay!", "group_id": 81, "id": 497654}]